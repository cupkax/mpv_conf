########
# Renderer #
########
vo                  = gpu-next
gpu-api             = d3d11
gpu-context         = d3d11
hwdec               = d3d11va-copy            
hwdec-codecs        = all
#d3d11-adapter       = NVIDIA GeForce RTX 3070 Laptop GPU
#vulkan-device       = NVIDIA GeForce RTX 3070 Laptop GPU


############
# Function #
############

title                           = ${?pause==yes:‚è∏}${?mute==yes:üîá}${?ontop==yes:üìå}${?demuxer-via-network==yes:${media-title}}${?demuxer-via-network==no:${filename}}
osc                             = no
no-title-bar 
window-corners                  = roundsmall
idle                            = yes
log-file                        = "~~/misc_files/logs/mpv.log"
ontop 
snap-window                     = yes
hr-seek                         = yes
hr-seek-framedrop               = no
save-position-on-quit           = yes
write-filename-in-watch-later-config
resume-playback-check-mtime     = yes
watch-later-dir                 = "~~/misc_files/_cache/watch_later"
watch-later-options             = start,vid,aid,sid
reset-on-next-file              = vf,af,loop-file,deinterlace,contrast,brightness,gamma,saturation,hue,video-zoom,video-rotate,video-pan-x,video-pan-y,panscan,speed,audio,sub,audio-delay,sub-pos,sub-scale,sub-delay,sub-speed,sub-visibility
input-ipc-server                = \\.\pipe\mpvsocket
directory-mode                  = auto
input-default-bindings          = no
metadata-codepage               = auto
msg-level=all=info
#ordered-chapters=no
#window-maximized=yes
#background="#778899"
#hidpi-window-scale=no
#auto-window-resize=yes
#geometry=75%x70%
#autofit=70%
#autofit-larger=80%x80%
#autofit-smaller=50%x50%
#window-scale=1
#keepaspect=no
#keepaspect-window=no
#panscan=1.0
#pause
#loop=inf
#loop-playlist=no
#keep-open=yes
#keep-open-pause=no
#fs
#no-border
#untimed

########
# Cache #
########
cache                  = yes
demuxer-max-bytes      = 419430400
demuxer-seekable-cache = yes
demuxer-max-back-bytes = 419430400
demuxer-readahead-secs = 1800
icc-cache-dir          = "~~/misc_files/_cache/icc"
gpu-shader-cache-dir   = "~~/misc_files/_cache/shader"
watch-later-directory  = "~~/misc_files/_cache/watch_later"

#######
# OSD #
#######
osc                    = no
##osd-bar                = no
#ursor-autohide        = 100
#msg-color              = yes
#term-osd-bar           = yes
no-osd-bar
osd-on-seek         = msg-bar
osd-bar-w           = 100
osd-bar-h           = 2
osd-bar-align-y     = -1
#osd-fonts-dir=~~/fonts
osd-font            = "Segoe UI Variable Display"
osd-font-size       = 24
osd-color           = "#FFFFFFFF"
osd-border-size     = 1.0
osd-border-color    = "#FF000000"
osd-shadow-offset   = 0.5
osd-shadow-color    = "#FF000000"
#osd-spacing=1
#osd-blur=0.5
osd-status-msg      = ${playback-time/full}/${duration/full}(${percent-pos}%)\nframe:${estimated-frame-number}/${estimated-frame-count}
osd-fractions       = yes
osd-duration        = 2000
#osd-playing-msg-duration=2000


########
# Audio #
########
#ao                     = wasapi
audio-device           = auto
audio-exclusive        = no
volume                 = 100       
volume-max             = 150       
audio-channels         = auto-safe
#audio-pitch-correction = yes
alang                  = kor,kr,jpn,jp,eng,en,enGB,en-GB,enUS,en-US,de,ger
audio-file-auto        = fuzzy


########
# Video #
########
#icc-profile-auto               = yes
#icc-profile                    = ~/AppData/Roaming/mpv/_cache/icc/M32U_rtings-icc-profile.icm                                                           
#icc-force-contrast             = no
video-sync                     = audio
#video-sync-max-video-change    = 1
#override-display-fps           = 60
interpolation                  = yes
tscale                         = oversample
target-prim                    = auto
target-trc                     = auto
video-output-levels            = full     
scale-antiring                 = 0.7 #Luma upscale deringing (Higher = Less ringing, but more detail loss)
dscale-antiring                = 0.7 #Luma downscale deringing (Higher = Less ringing, but more detail loss)
cscale-antiring                = 0.7 #Chroma upscale deringing (Higher = Less ringing, but more detail loss)


####################
# Autoload #
####################
load-auto-profiles         = auto
load-osd-console           = yes
load-stats-overlay         = yes
ytdl                       = yes


########
# Subs #
########
sub-auto                           = fuzzy
slang                              = eng,en,enGB,en-GB,enUS,en-US
blend-subtitles                    = yes                
sub-font                           = "Open Sans SemiBold"
sub-font-size                      = 40
sub-blur                           = 0.3
sub-border-color                   = 0.0/0.0/0.0/0.8
sub-border-size                    = 3.2
sub-color                          = 1.0/1.0/1.0/1.0
sub-margin-x                       = 100
sub-margin-y                       = 50
sub-shadow-color                   = 0.0/0.0/0.0/0.25
sub-shadow-offset                  = 0
sub-back-color                     = "#00000000"
sub-use-margins                    = yes
sub-gauss                          = 0.6						
sub-file-paths-append              = ass               	
sub-file-paths-append              = srt
sub-file-paths-append              = sub
sub-file-paths-append              = subs
sub-file-paths-append              = subtitles
demuxer-mkv-subtitle-preroll       = yes       	
demuxer-mkv-subtitle-preroll-secs  = 2
embeddedfonts                      = no
sub-ass-override                   = yes
sub-ass-scale-with-window          = no
sub-ass-force-margins              = no 
sub-ass-vsfilter-aspect-compat     = yes         
sub-ass-vsfilter-blur-compat       = yes         
sub-ass-vsfilter-color-compat      = basic  


########
# Screenshot #
########
#screenshot-template            = "~~/misc_files/screens/Screenshot-%F-T%wH.%wM.%wS.%wT-F%{estimated-frame-number}"
screenshot-template            = "~~/misc_files/screens/%{media-title}-%P-%n"
screenshot-format              = png
screenshot-tag-colorspace      = yes
screenshot-high-bit-depth      = yes


##############
# Supplement #
##############

#d3d11-output-csp=pq
#use-filedir-conf
#include="~~/profiles.conf"
#libplacebo-opts=perceptual_deadzone=0.8,tone_map_metadata=cie_y
libplacebo-opts=tone_map_metadata=cie_y

##‚áò‚áòThe following is the conventional configuration profile to enable the parameters to choose to use depending on the needs
#profile=ICC                                  # ICC color management configuration profile, the displayed ICC display configuration file by the operating system display settings
#profile=ICC+                                 # ICC color management configuration profile, use the pan -ICC configuration file or professional school color file provided by Color.org, select the ICC configuration file of the color gamut corresponding to the color gamut by itself
profile=Target                                # Target color management configuration profile cannot coexist with ICC color management
profile=Dither                                # The shaking algorithm configuration profile (FRUIT), the effect is close to the error-diffusion, which is low energy consumption
#profile=Dither+                              # The shake algorithm configuration profile (Error-Diffusion), the color deep trembling algorithm of the error diffusion, the best effect and the most energy-consuming
profile=Tscale                                # [Before enabled, comment --tscale=<Value>] Time domain interpolation algorithm, see the same name configuration in the configuration area below
#profile=Tscale+                              # [Before enabled, comment --tscale=<Value>] The time domain interpolation algorithm for the selected, see the configuration of the same name below in the configuration area below
profile=HQ                                    # The most commonly used built -in algorithm configuration profile
profile=DeBand-low                            # [Before enlightenment, you need to comment --deband] The selected tape scheme. See the same name configuration in the configuration area below.
#profile=HDR-PASS                             # The HDR direct parameter configuration profile can only be set during initialization. When HDR is directly connected, it needs to be disabled --icc-profile,icc-profile-auto,--target-trc parameters.
                                              # --vo=gpu-next --gpu-api=vulkan and full-screen (restrictions on Windows) are available, --gpu-api=d3d11 You need to manually switch the display HDR mode (Windows limit)
#profile=SDR2HDR                              # The SDR mapping HDR parameter configuration profile is only valid on HDR devices, and it is not recommended to enable.Limited --vo=gpu-next is available
profile=HDR2SDR                               # HDR mapping parameter configuration profile
#profile=SWscaler                             # Software scaling scheme

## The following is the color device configuration profile, which can be enabled by the following required configuration profile (this will cover the above --glsl-shaders-append parameter)
profile=NNEDI3                                # Applicable to most scenariosÔºàNNEDI3-32Ôºâ                              ## Most of the scenes perform well, and the adaptability of the scene is better than the FSRCNNX configuration (inhibiting aliasing, ringing, artifact).I like to use this configuration profile with priority
#profile=NNEDI3+                              # Applicable to low analysis scenariosÔºàNNEDI3-64Ôºâ                      ## Theoretically, the NNEDI3-64 and above variants have a better suppression of the artifact effect, but the energy consumption has doubled, and whether the performance of the equipment is used
#profile=AMD-FSR_EASU                         # Applicable to most scenariosÔºàAMD-FSR_EASUÔºâ                           ## The EASU variant in AMD's FSR algorithm performs well. Compared with the FSR and RCAS variants, there are fewer ringing and artifacts. At the same time, it has a good picture effect. Magnify to the target resolution
#profile=Normal                               # Suitable for HD sceneÔºàFSRCNNXÔºâ                                       ## The effect is similar to the NGU Sharp of MADVR, but produces more ringing and artifacts.
#profile=Normal+                              # Applicable to low analysis scenariosÔºàFSRCNNX_enhanceÔºâ                ## It has excellent inhibitory ringing and artifact effects for low analysis real images
#profile=Anime                                # Suitable for HD animationÔºàFSRCNNX_LineArtÔºâ                           ## The effect is similar to the NGU AA of MADVR, but it produces more ringing and artifacts.
#profile=Anime+                               # Applicable to low analysis animationÔºàFSRCNNX_anime_enhanceÔºâ          ## It has an excellent inhibitory bell pseudo shadow effect on the anime image of low analysis
#profile=ravu                                 # Applicable to most animationsÔºàravu-rÔºâ                                ## The sharpness is very good, but it will produce ringing and artifacts
#profile=ravu-zoom                            # Applicable to most scenariosÔºàravu-zoomÔºâ                              ## Magnify to the target resolution
#profile=ravu-lite                            # Applicable to most scenariosÔºàravu-liteÔºâ                              ## The sharpest and fast variant, but it will produce more bells
#profile=ravu-3x                              # Applicable to low analysis animationÔºàravu-3xÔºâ                        ## The effect is similar to the NGU AA of MADVR, which is more suitable for Anime
#profile=ACNet                                # Applicable to low analysis animationÔºàACNetÔºâ
#profile=ACNet+                               # Applicable to low analysis animationÔºàACNet Noise reduction planÔºâ
#profile=Anime4K                              # Applicable to most animationsÔºàAnime4k anti-aliasingÔºâ                 ## It can have a good inhibitory effect on flaws such as sawtooth bells, and there is still obvious perception.
#profile=Anime4K+                             # Applicable to low analysis animationÔºàAnime4k high anti-aliasingÔºâ     ## It has a better effect of inhibiting flaws such as sawtooth ringing and artifacts for Anime images, and its strength is higher.The actual effect of UL variants is the best, but the energy consumption is extremely high. It is not recommended to use it for the time being
#profile=SSIM                                 # Applicable to low performance consumption


#########################
# Conventional profiles #
#########################

## The conventional configuration does not have an automatic trigger condition (the built -in configuration profile is all conventional configuration)
## Need to use in the main settings file-Profile = <Profile1, Profile2, ...> Or multi-line-PROFILE = <xxx> Parameter activation several configuration several configurations several configurations

[ICC]
icc-profile=""
icc-profile-auto
icc-intent=0
icc-force-contrast=1000
icc-3dlut-size=64x64x64
icc-cache-dir="~~/misc_files/_cache/icc"

[ICC+]
#icc-profile="~~/icc/ITU-RBT709ReferenceDisplay.icc"
icc-profile=""
icc-intent=0
icc-force-contrast=no
icc-3dlut-size=64x64x64
icc-cache-dir="~~/misc_files/_cache/icc"

[Target]
icc-profile=""
icc-profile-auto=no
target-prim=auto
target-trc=gamma2.2
target-contrast=auto
target-peak=auto

[Dither]
dither-depth=auto
dither=fruit
dither-size-fruit=6

[Dither+]
dither-depth=auto
dither=error-diffusion
error-diffusion=floyd-steinberg

[Tscale]
video-sync=display-resample
#video-sync-max-video-change=5
interpolation
#interpolation-preserve=no
tscale=oversample

[Tscale+]
video-sync=display-resample
#video-sync-max-video-change=5
interpolation
#interpolation-preserve=no
tscale=sphinx
tscale-blur=0.65

[HQ]
scale=ewa_hanning
cscale=bilinear
dscale=catmull_rom
scale-antiring=0.5
dscale-antiring=0.5
linear-upscaling=no
sigmoid-upscaling=yes
correct-downscaling=yes
linear-downscaling=no
deband=no

[DeBand-low]
profile-desc=DeBand low
deband-iterations=1
deband-threshold=48
deband-range=16
deband-grain=16

[DeBand-medium]
profile-desc=deband medium
deband-iterations=2
deband-threshold=64
deband-range=16
deband-grain=24

[DeBand-high]
profile-desc=deband high
deband-iterations=3
deband-threshold=64
deband-range=16
deband-grain=24


[HDR-PASS]
profile-desc=HDR passthrough
target-colorspace-hint=yes

[SDR2HDR]
profile-desc=expanding SDR to HDR
inverse-tone-mapping=yes

[HDR2SDR]
profile-desc=HDR to SDR Mapping parameter
tone-mapping=auto
#tone-mapping-param=1.0
#tone-mapping-max-boost=1.0
gamut-mapping-mode=auto
hdr-contrast-recovery=0.30
#hdr-contrast-smoothness=3.5
hdr-compute-peak=auto
hdr-peak-percentile=99.995
hdr-peak-decay-rate=20
hdr-scene-threshold-low=1.0
hdr-scene-threshold-high=3.0
allow-delayed-peak-detect=no

[SWscaler]
profile-desc=Software scaling configuration
sws-allow-zimg=no
sws-scaler=bicublin
#sws-fast=yes
zimg-scaler-chroma=bicubic
#zimg-scaler-chroma-param-a=1/3
#zimg-scaler-chroma-param-b=1/3
zimg-scaler=bicubic
zimg-scaler-param-a=1/3
zimg-scaler-param-b=1/3
#zimg-dither=error-diffusion
zimg-fast=no


[NNEDI3]
profile-desc=Applicable to most scenarios
glsl-shaders="~~/shaders/nnedi3/nnedi3-nns32-win8x4.glsl;~~/shaders/igv/KrigBilateral.glsl;~~/shaders/igv/SSimSuperRes.glsl;~~/shaders/igv/SSimDownscaler.glsl"

[NNEDI3+]
profile-desc=Applicable to low analysis scenarios
glsl-shaders="~~/shaders/nnedi3/nnedi3-nns64-win8x4.glsl;~~/shaders/igv/KrigBilateral.glsl;~~/shaders/igv/SSimSuperRes.glsl;~~/shaders/igv/SSimDownscaler.glsl"

[AMD-FSR_EASU]
profile-desc=Applicable to most scenarios
glsl-shaders="~~/shaders/igv/KrigBilateral.glsl;~~/shaders/AMD-FSR/AMD-FSR-EASU_rgb.glsl;~~/shaders/igv/SSimDownscaler.glsl"

[Normal]
profile-desc=Suitable for HD scene
glsl-shaders="~~/shaders/igv/FSRCNNX_x2_8-0-4-1.glsl;~~/shaders/igv/KrigBilateral.glsl;~~/shaders/igv/SSimSuperRes.glsl;~~/shaders/igv/SSimDownscaler.glsl"

[Normal+]
profile-desc=Applicable to low analysis scenarios
glsl-shaders="~~/shaders/igv/FSRCNNX_x2_16-0-4-1_enhance.glsl;~~/shaders/igv/KrigBilateral.glsl;~~/shaders/igv/SSimSuperRes.glsl;~~/shaders/igv/SSimDownscaler.glsl"

[Anime]
profile-desc=Suitable for HD animation
glsl-shaders="~~/shaders/igv/FSRCNNX_x2_8-0-4-1_LineArt.glsl;~~/shaders/igv/KrigBilateral.glsl;~~/shaders/igv/SSimSuperRes.glsl;~~/shaders/igv/SSimDownscaler.glsl"

[Anime+]
profile-desc=Applicable to low analysis animation
glsl-shaders="~~/shaders/igv/FSRCNNX_x2_16-0-4-1_anime_enhance.glsl;~~/shaders/igv/KrigBilateral.glsl;~~/shaders/igv/SSimSuperRes.glsl;~~/shaders/igv/SSimDownscaler.glsl"

[ravu]
profile-desc=Applicable to most animations
glsl-shaders="~~/shaders/ravu/ravu-r3.glsl;~~/shaders/igv/KrigBilateral.glsl;~~/shaders/igv/SSimDownscaler.glsl"

[ravu-3x]
profile-desc=Applicable to low analysis animation
glsl-shaders="~~/shaders/ravu/ravu-3x-r3.glsl;~~/shaders/igv/KrigBilateral.glsl;~~/shaders/igv/SSimSuperRes.glsl;~~/shaders/igv/SSimDownscaler.glsl"

[ravu-zoom]
profile-desc=Applicable to most scenarios
glsl-shaders="~~/shaders/ravu/ravu-zoom-ar-r3.glsl;~~/shaders/igv/KrigBilateral.glsl;~~/shaders/igv/SSimDownscaler.glsl"

[ravu-lite]
profile-desc=Applicable to most scenarios
glsl-shaders="~~/shaders/ravu/ravu-lite-ar-r3.glsl;~~/shaders/igv/KrigBilateral.glsl;~~/shaders/igv/SSimSuperRes.glsl;~~/shaders/igv/SSimDownscaler.glsl"

[ACNet]
profile-desc=Applicable to low analysis animation
glsl-shaders="~~/shaders/ACNet/ACNet.glsl;~~/shaders/ACNet/ACNet.glsl;~~/shaders/igv/KrigBilateral.glsl;~~/shaders/igv/SSimSuperRes.glsl;~~/shaders/igv/SSimDownscaler.glsl"

[ACNet+]
profile-desc=Applicable to low analysis animation-Reinforcement noise reduction
glsl-shaders="~~/shaders/ACNet/ACNet_HDN_L1.glsl;~~/shaders/ACNet/ACNet.glsl;~~/shaders/igv/KrigBilateral.glsl;~~/shaders/igv/SSimSuperRes.glsl;~~/shaders/igv/SSimDownscaler.glsl"

[Anime4K]
profile-desc=Anime4K
glsl-shaders="~~/shaders/igv/KrigBilateral.glsl;~~/shaders/Anime4K/Anime4K_Restore_CNN_Soft_M.glsl;~~/shaders/Anime4K/Anime4K_Clamp_Highlights.glsl"

[Anime4K+]
profile-desc=Anime4K+
glsl-shaders="~~/shaders/igv/KrigBilateral.glsl;~~/shaders/Anime4K/Anime4K_Restore_CNN_Soft_VL.glsl;~~/shaders/Anime4K/Anime4K_Clamp_Highlights.glsl"

[SSIM]
profile-desc=Applicable to 4K low performance
glsl-shaders="~~/shaders/other/FastBilateral.glsl;~~/shaders/igv/SSimSuperRes.glsl;~~/shaders/igv/SSimDownscaler.glsl"

################
# Auto-profiles #
################

[Deband]
profile-desc=The source below the yuv420p10 opens the ribbon
profile-cond=p["video-params/average-bpp"] < 24
profile-restore=copy
deband=yes

[hdr-2390]
profile-cond=p.tone_mapping == "bt.2390" and p.current_vo == "gpu-next"
profile-restore=copy
tone-mapping-param=2.0

#[hdr-spline]
#profile-cond=p.tone_mapping == "spline"
#profile-restore=copy
#tone-mapping-param=1.0

#[DoVi-P5]
#profile-cond=p["video-out-params/max-luma"] > 203 and p["video-params/gamma"] == "bt.1886"
#profile-restore=copy
#target-trc=bt.2020
#target-gamut=dci-p3
#target-trc=pq

[HDR]
profile-desc=HDR configuration
profile-cond=p["video-out-params/max-luma"] > 203
profile-restore=copy
#icc-profile=""
#icc-profile-auto=no
#target-trc=auto
#target-peak=100
blend-subtitles=no
deband=no
vf=""

[SDR-Gamut]
profile-cond=p["video-params/primaries"] ~= "bt.709" and p["video-params/gamma"] == "bt.1886"
profile-restore=copy
gamut-mapping-mode=clip

[rot-fix]
#issue: https://github.com/mpv-player/mpv/issues/8223
profile-desc=Fix the chroma destruction of the rotation output
profile-cond=(p["video-params/rotate"] == 90 or p["video-params/rotate"] == 270) and p.current_vo ~= "gpu-next"
profile-restore=copy
hwdec=no
glsl-shaders=""

[video-sync]
profile-cond=(speed*audio_speed_correction) > 0 and ((speed*audio_speed_correction) < 0.96 or (speed*audio_speed_correction) > 1.04) and not (p["estimated-vf-fps"] > 47 or p["display-fps"] > 120)
profile-restore=copy-equal
video-sync=display-tempo

[fps-fix]
profile-desc=Fix the abnormal energy consumption or drop frame caused by the high refresh rate of the video frame rate and display rate
profile-cond=p["estimated-vf-fps"] > 47 or p["display-fps"] > 120
profile-restore=copy
video-sync=audio

[8k-fix]
profile-desc=Using D3D11VA hard solution on 8KAV1 to solve the frame loss problem. This scheme is limited to --gpu-api=d3d11 is available
profile-cond=p["video-params/w"] > 7000 or p["video-params/h"] > 3000
profile-restore=copy
hwdec=auto-safe
video-sync=audio

[audio-filter]
profile-desc=When the audio channel is greater than 2, the dynamic range adjustment filter is used for dual channel equipment
profile-cond=p["audio-params/channel-count"] > 2
profile-restore=copy-equal
af-pre=@dynaudnorm:lavfi=[dynaudnorm=g=5:f=250:r=0.9:p=0.5]

[pause]
profile-desc=Disable the top when pause
profile-cond=pause
profile-restore=copy
ontop=no

#[fullscreen]
#profile-desc=Full-screen automatic top
#profile-cond=fullscreen or window_maximized
#profile-restore=copy
#ontop

[minimized]
profile-desc=Pause when minimizing
profile-cond=window_minimized and vid and not p["current-tracks/video/albumart"]
profile-restore=copy-equal
pause

[end]
profile-desc=Exit the full screen after the playlist is over
profile-cond=idle_active
no-fullscreen
no-window-maximized

[media-title]
profile-desc=Switch window title display content under special protocol
profile-cond=path:find('://') ~= nil or path:find('^magnet:') ~= nil
#profile-cond=demuxer_via_network==true
profile-restore=copy
title=${?pause==yes:‚è∏}${?mute==yes:üîá}${?ontop==yes:üìå}${media-title}

#[image]
#profile-cond=vid and not p["current-tracks/video/albumart"] and estimated_frame_count <= 1
#profile-restore=copy
#prefetch-playlist
#image-display-duration=inf
#scale=ewa_hanning
#cscale=ewa_hanning
#dscale=mitchell

#[audio]
#profile-cond=aid and (not vid or p["current-tracks/video/albumart"])
#profile-restore=copy
#prefetch-playlist
#loop-playlist=inf

##‚áò‚áò Implement the MPV window automatically switch parameters and configuration files according to the display name with display-name.lua script (only Windows), dependence MultiMonitorTool.exe
#[TV]
#profile-cond=p["user-data/display_name"]=='VX2771-4K-HD'
#profile-restore=copy-equal
#dither-depth=10
#inverse-tone-mapping=yes
#target-colorspace-hint=yes
#script-opts-append=changerefresh-auto=yes
#script-opts-append=changerefresh-rates=23;24;25-50;29-59;30-60;50;59;60