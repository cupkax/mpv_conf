########
# Renderer #
########
vo                  = gpu-next
gpu-api             = vulkan
#gpu-context         = d3d11
#hwdec               = auto-copy            
#hwdec-codecs        = all
#d3d11-adapter       = NVIDIA GeForce RTX 3070 Laptop GPU
vulkan-device       = NVIDIA GeForce RTX 3070 Laptop GPU


########
# Misc #
########
input-ipc-server       = \\.\pipe\mpvsocket     # Enable JSON-based protocol
input-builtin-bindings = yes
input-default-bindings = yes
hr-seek-framedrop      = no
save-position-on-quit  = yes
#watch-later-options    = start,osd-level,speed,edition,pause,volume,mute,audio-delay,fullscreen,ontop,border,gamma,brightness,contrast,saturation,hue,deinterlace,vf,af,panscan,aid,vid,sid,sub-delay,sub-speed,sub-pos,sub-visibility,sub-scale,sub-use-margins,sub-ass-force-margins,sub-ass-vsfilter-aspect-compat,sub-ass-override,ab-loop-a,ab-loop-b,video-aspect-overrideosd-level,speed,edition,pause,volume,mute,audio-delay,fullscreen,ontop,border,gamma,brightness,contrast,saturation,hue,deinterlace,vf,af,panscan,aid,vid,sid,sub-delay,sub-speed,sub-pos,sub-visibility,sub-scale,sub-use-margins,sub-ass-force-margins,sub-ass-vsfilter-aspect-compat,sub-ass-override,ab-loop-a,ab-loop-b,video-aspect-override


########
# General #
########
fs                     = yes         
keep-open              = yes          
ontop                  = no          
border                 = no
geometry               = 100%:100%
auto-window-resize     = yes
keepaspect-window      = yes
hidpi-window-scale     = yes
#title                  = '${filename}'
title                  = ${?filename:[${playlist-pos-1}/${playlist-count}] ${time-pos} / ${duration} (${percent-pos}%) | ${filename}}${!filename:No file.}

########
# Cache #
########
cache                  = yes
demuxer-max-bytes      = 2000MiB
demuxer-seekable-cache = yes
demuxer-max-back-bytes = 1200M
#demuxer-readahead-secs = 1800
icc-cache-dir          = "~/AppData/Roaming/mpv/_cache/icc"
gpu-shader-cache-dir   = "~/AppData/Roaming/mpv/_cache/shader"
watch-later-directory  = "~/AppData/Roaming/mpv/_cache/watch_later"

#######
# OSD #
#######
osc                    = no
osd-bar                = no
cursor-autohide        = 100
msg-color              = yes
term-osd-bar           = yes


########
# Audio #
########
#ao                     = wasapi
audio-device           = auto
audio-exclusive        = no
volume                 = 100       
volume-max             = 150       
audio-channels         = auto-safe
#audio-pitch-correction = yes
alang                  = kor,kr,jpn,jp,eng,en,enGB,en-GB,enUS,en-US,de,ger
audio-file-auto        = fuzzy


########
# Video #
########
#icc-profile-auto               = yes
icc-profile                    = ~/AppData/Roaming/mpv/_cache/icc/M32U_rtings-icc-profile.icm                                                           
icc-force-contrast             = no
video-sync                     = display-resample
video-sync-max-video-change    = 1
override-display-fps           = 60
interpolation                  = yes
tscale                         = oversample
target-prim                    = auto
target-trc                     = auto
video-output-levels            = full     
scale-antiring                 = 0.7 #Luma upscale deringing (Higher = Less ringing, but more detail loss)
dscale-antiring                = 0.7 #Luma downscale deringing (Higher = Less ringing, but more detail loss)
cscale-antiring                = 0.7 #Chroma upscale deringing (Higher = Less ringing, but more detail loss)


####################
# Autoload #
####################
load-auto-profiles         = auto
load-osd-console           = yes
load-stats-overlay         = yes
ytdl                       = yes


########
# Subs #
########
sub-auto                           = fuzzy
slang                              = eng,en,enUS
blend-subtitles                    = no                
sub-font                           = "Open Sans SemiBold"
sub-font-size                      = 40
sub-blur=0.3
sub-border-color                   = 0.0/0.0/0.0/0.8
sub-border-size                    = 3.2
sub-color                          = 0.9/0.9/0.9/1.0
sub-margin-x                       = 100
sub-margin-y                       = 50
sub-shadow-color                   = 0.0/0.0/0.0/0.25
sub-shadow-offset                  = 0
sub-back-color                     = "#00000000"
sub-use-margins                    = yes
sub-gauss                          = 0.6						
sub-file-paths-append              = ass               	
sub-file-paths-append              = srt
sub-file-paths-append              = sub
sub-file-paths-append              = subs
sub-file-paths-append              = subtitles
demuxer-mkv-subtitle-preroll       = yes       	
demuxer-mkv-subtitle-preroll-secs  = 2
embeddedfonts                      = no
sub-ass-override                   = yes
sub-ass-scale-with-window          = no
sub-ass-force-margins              = no 
sub-ass-vsfilter-aspect-compat     = yes         
sub-ass-vsfilter-blur-compat       = yes         
sub-ass-vsfilter-color-compat      = basic  


########
# Screenshot #
########
screenshot-template            ="%x\Screens\Screenshot-%F-T%wH.%wM.%wS.%wT-F%{estimated-frame-number}"
screenshot-format              = png
screenshot-tag-colorspace      = yes
screenshot-high-bit-depth      = yes


########
# Profiles #
########
[default]
glsl-shaders-clr
deband                 = no
dither                 = fruit
scale                  = ewa_lanczos
scale-blur             = 0.981251 # Scale blur for gpu-next
cscale                 = lanczos
dscale                 = mitchell
correct-downscaling    = yes
linear-downscaling     = no
sigmoid-upscaling      = yes
scaler-resizes-only    = no
glsl-shaders           = "~/AppData/Roaming/mpv/shaders/FSRCNNX_x2_8_0_4_1.glsl;~/AppData/Roaming/mpv/shaders/SSimSuperRes.glsl;~/AppData/Roaming/mpv/shaders/SSimDownscaler.glsl;~/AppData/Roaming/mpv/shaders/KrigBilateral.glsl"

[ultra-hd] # 2160p
profile-desc               = ultra-hd
profile-cond               = ((width ==3840 and height ==2160))
profile                    = default
#glsl-shaders-append        = "~/AppData/Roaming/mpv/shaders/noise_static_chroma.glsl"
#glsl-shaders-append        = "~/AppData/Roaming/mpv/shaders/noise_static_luma.glsl"
#glsl-shaders-append        = "~/AppData/Roaming/mpv/shaders/adaptive-sharpen.glsl"
#target-colorspace-hint     = yes
hdr-compute-peak           = yes
hdr-peak-decay-rate        = 150        
hdr-scene-threshold-low    = 4
hdr-scene-threshold-high   = 16
tone-mapping               = bt.2390
tone-mapping-mode          = hybrid
tone-mapping-max-boost     = 1.5
gamut-mapping-mode         = clip
vd-lavc-threads            = 32

[full-hd] # 1080p
profile-desc           = full-hd
profile-cond           = ((width ==1920 and height ==1080) and not p["video-frame-info/interlaced"])
profile                = default
#glsl-shaders-append    = "~/AppData/Roaming/mpv/shaders/noise_static_chroma.hook"
#glsl-shaders-append    = "~/AppData/Roaming/mpv/shaders/noise_static_luma.hook"

[hd] # 720p
profile-desc           = hd
profile-cond           = ((width ==1280 and height ==720))
deband-grain           = 100

[low-res] # <720p
profile-desc           = low-res
profile-cond           = (get('height', math.huge) < 720)
glsl-shaders-append    = "~/AppData/Roaming/mpv/shaders/adaptive-sharpen.glsl"
deband-grain           = 60
vf                     = bwdif # apply FFMPEG's bwdif deinterlacer


[protocol-network]
network-timeout        = 5
hls-bitrate            = max
cache                  = yes
demuxer-max-bytes      = 2000MiB
demuxer-readahead-secs = 300

[protocol.http]
profile                = protocol-network

[protocol.https]
profile                = protocol-network